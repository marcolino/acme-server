

  API tests - Auth routes
hashPassword, salt: $2a$10$4QT4zSepUDH8u2VIHW0afu
[0mPOST /api/auth/signup [32m201[0m 84.750 ms - 145[0m
    âœ” should register user (98ms)
[0mPOST /api/auth/signup [33m401[0m 2.756 ms - 138[0m
    âœ” should not register user without confirmation
[0mPOST /api/auth/signup [33m400[0m 1.954 ms - 41[0m
    âœ” should not register user with invalid email
[0mPOST /api/auth/signup [33m400[0m 4.385 ms - 43[0m
    âœ” should not register user forcing invalid plan
[0mPOST /api/auth/signup [33m400[0m 6.490 ms - 43[0m
    âœ” should not register user forcing invalid role
[0mPOST /api/auth/signin [33m401[0m 13.372 ms - 138[0m
    âœ” should not login user before confirmation
[0mPOST /api/auth/resendSignupCode [32m200[0m 3.847 ms - 105[0m
    âœ” should resend register code
[0mPOST /api/auth/signupVerification [33m400[0m 0.799 ms - 31[0m
    âœ” should not confirm user without code
[0mPOST /api/auth/signupVerification [33m400[0m 2.128 ms - 55[0m
    âœ” should not confirm user with invalid code
[0mPOST /api/auth/signupVerification [32m200[0m 14.171 ms - 63[0m
    âœ” should confirm user
[0mPOST /api/auth/signupVerification [33m400[0m 6.333 ms - 52[0m
    âœ” should not confirm user twice
[0mPOST /api/auth/resendSignupCode [33m400[0m 4.206 ms - 68[0m
    âœ” should not resend register code for already confirmed user
[0mPOST /api/auth/resendSignupCode [33m401[0m 5.793 ms - 119[0m
    âœ” should not resend register code without email
[0mPOST /api/auth/resetPassword [33m400[0m 1.689 ms - 42[0m
    âœ” should not reset password without email
[0mPOST /api/auth/resetPassword [32m200[0m 6.167 ms - 148[0m
    âœ” should start reset password
hashPassword, salt: $2a$10$wpMLu/bgwwwNkQ9d61yF5.
[0mPOST /api/auth/resetPasswordConfirm [32m200[0m 66.849 ms - 44[0m
    âœ” should confirm reset password (69ms)
[0mPOST /api/auth/resetPasswordConfirm [33m400[0m 1.563 ms - 73[0m
    âœ” should not confirm reset password with wrong email
[0mPOST /api/auth/resetPasswordConfirm [33m400[0m 0.641 ms - 57[0m
    âœ” should not confirm reset password with no code
[0mPOST /api/auth/resetPasswordConfirm [33m400[0m 1.694 ms - 73[0m
    âœ” should not confirm reset password with wrong code
[0mPOST /api/auth/resendResetPasswordCode [33m401[0m 1.744 ms - 128[0m
    âœ” should not resend reset password code to invalid email
[0mPOST /api/auth/resendResetPasswordCode [32m200[0m 5.058 ms - 129[0m
    âœ” should resend reset password code
[0mPOST /api/auth/signin [33m400[0m 0.932 ms - 32[0m
    âœ” should not login user with invalid email
[0mPOST /api/auth/signin [33m401[0m 1.646 ms - 28[0m
    âœ” should not login user with unregistered email
[0mPOST /api/auth/signin [32m200[0m 61.788 ms - 513[0m
    âœ” should login user (63ms)
[0mPOST /api/auth/signin [32m200[0m 58.466 ms - 513[0m
    âœ” should login user with passepartout password (60ms)
[0mPOST /api/auth/signin [33m401[0m 58.793 ms - 47[0m
    âœ” should not login user with invalid password (60ms)
hashPassword, salt: $2a$10$Mkx8o76wCtN..wbBdzu0h.
[0mPOST /api/auth/signup [32m201[0m 61.082 ms - 147[0m
    âœ” should register admin user (62ms)
[0mPOST /api/auth/signupVerification [32m200[0m 3.767 ms - 63[0m
    âœ” should confirm admin user
[0mPOST /api/auth/signin [32m200[0m 61.256 ms - 517[0m
    âœ” should login admin user (62ms)
[0mPOST /api/auth/refreshtoken [33m401[0m 0.620 ms - 46[0m
    âœ” should not refresh token without refresh token
[0mPOST /api/auth/refreshtoken [33m401[0m 0.458 ms - 46[0m
    âœ” should not refresh token with invalid refresh token
[0mPOST /api/auth/refreshtoken [32m200[0m 2.080 ms - 243[0m
    âœ” should refresh token

  API tests - Payment routes
hashPassword, salt: $2a$10$JtJQ/bT/cfHY8TI/qw6b3.
[0mPOST /api/auth/signup [32m201[0m 61.697 ms - 145[0m
[0mPOST /api/auth/signupVerification [32m200[0m 3.660 ms - 63[0m
    âœ” should register normal user (68ms)
[0mPOST /api/auth/signin [32m200[0m 63.045 ms - 513[0m
    âœ” should login normal user (64ms)
[0mGET /api/payment/mode [32m200[0m 1.269 ms - 15[0m
    âœ” should get payment mode, and it should be in a set of values
[0mPOST /api/payment/createCheckoutSession [33m401[0m 0.706 ms - 101[0m
    âœ” should not create a checkout session without authentication
[0mPOST /api/payment/createCheckoutSession [33m400[0m 818.966 ms - 168[0m
    âœ” should not create a checkout session for a 0 cost product (821ms)
[0mPOST /api/payment/createCheckoutSession [33m400[0m 403.529 ms - 95[0m
    âœ” should not create a checkout session for a non-existent product (406ms)
[0mPOST /api/payment/createCheckoutSession [32m200[0m 1022.335 ms - -[0m
    âœ” should create a checkout session for a standard product (1030ms)
[0mGET /api/payment/paymentSuccess?session_id=cs_test_a1KbtCcf2bQvqDBRfKHQbnaLyttRFQER22QoorZWqADtbzassXusYsLU6k [36m302[0m 810.334 ms - 76[0m
    âœ” should redirect on a payment success call (814ms)
[0mGET /api/payment/paymentCancel?session_id=cs_test_a1KbtCcf2bQvqDBRfKHQbnaLyttRFQER22QoorZWqADtbzassXusYsLU6k [36m302[0m 815.262 ms - 75[0m
    âœ” should redirect on a payment canceled call (818ms)

  API tests - User routes
hashPassword, salt: $2a$10$GRkVG4XauOXMiWjF8aVvcu
[0mPOST /api/auth/signup [32m201[0m 65.223 ms - 145[0m
[0mPOST /api/auth/signupVerification [32m200[0m 3.504 ms - 63[0m
    âœ” should register normal user (71ms)
[0mPOST /api/auth/signin [32m200[0m 59.250 ms - 513[0m
    âœ” should login normal user (60ms)
hashPassword, salt: $2a$10$qHt0pagaKF8.jaFAMUjsF.
[0mPOST /api/auth/signup [32m201[0m 61.681 ms - 147[0m
[0mPOST /api/auth/signupVerification [32m200[0m 4.124 ms - 63[0m
    âœ” should register admin user (68ms)
[0mPOST /api/auth/signin [32m200[0m 60.419 ms - 532[0m
    âœ” should login as admin user (61ms)
[0mGET /api/user/getAllUsersWithFullInfo [33m403[0m 2.713 ms - 67[0m
    âœ” should not get all users with full info with user role
[0mGET /api/user/getAllUsersWithFullInfo [32m200[0m 7.742 ms - 1010[0m
    âœ” should get all users with full info with admin role
[0mGET /api/user/getAllRoles [33m401[0m 0.969 ms - 101[0m
    âœ” should not get all roles without authentication
[0mGET /api/user/getAllRoles [32m200[0m 4.091 ms - 270[0m
    âœ” should get all roles
[0mGET /api/user/getAllPlans [33m401[0m 0.623 ms - 101[0m
    âœ” should not get alls plans without authentication
[0mGET /api/user/getAllPlans [32m200[0m 2.280 ms - 371[0m
    âœ” should get all plans
[0mGET /api/user/getUser [32m200[0m 5.002 ms - 477[0m
    âœ” should get user's profile
[0mGET /api/user/getUser [33m401[0m 0.576 ms - 101[0m
    âœ” should not get user's profile without authentication
[0mGET /api/user/getUser [33m403[0m 3.482 ms - 113[0m
    âœ” should not get another user's profile without admin access
[0mGET /api/user/getUser [32m200[0m 4.047 ms - 496[0m
    âœ” should get another user's profile with admin access
[0mPOST /api/user/updateUser [32m200[0m 7.482 ms - 664[0m
    âœ” should update user's profile
[0mPOST /api/user/updateUser [33m400[0m 5.740 ms - 41[0m
    âœ” should not update user's profile with invalid email
[0mPOST /api/user/updateUser [33m400[0m 8.044 ms - 48[0m
    âœ” should not update user's profile with already taken email
[0mPOST /api/user/updateUser [32m200[0m 8.472 ms - 500[0m
    âœ” should update user's profile with new email
[0mPOST /api/user/updateUser [32m200[0m 8.399 ms - 496[0m
    âœ” should reset user's profile with email
[0mPOST /api/user/updateUser [33m400[0m 6.941 ms - 47[0m
    âœ” should not update user's profile with empty firstName
[0mPOST /api/user/updateUser [33m400[0m 5.591 ms - 46[0m
    âœ” should not update user's profile with invalid lastName
[0mPOST /api/user/updateUser [33m400[0m 4.515 ms - 45[0m
    âœ” should not update user's profile with invalid fiscalCode
[0mPOST /api/user/updateUser [33m401[0m 0.601 ms - 101[0m
    âœ” should not update user's profile without autentication
[0mPOST /api/user/updateUser [33m403[0m 2.710 ms - 113[0m
    âœ” should not update user's profile for a different not existing user - without admin access
[0mPOST /api/user/updateUser [33m403[0m 3.035 ms - 113[0m
    âœ” should not update user's profile for a different existent user - without admin access
[0mPOST /api/user/updateUser [32m200[0m 7.796 ms - 653[0m
    âœ” should update user's profile for a different existent user - as admin user
[0mPOST /api/user/updateUser [33m403[0m 3.272 ms - 113[0m
    âœ” should not update another user's own property without admin access
[0mPOST /api/user/updateUser [32m200[0m 6.496 ms - 664[0m
    âœ” should update another user's property with admin access
[0mPOST /api/user/updateUser [32m200[0m 4.681 ms - 496[0m
    âœ” should update user's property (with no changes) with an unexpected parameters
[0mPOST /api/user/updateUser [32m200[0m 4.228 ms - 664[0m
    âœ” should update user's own property firstName
[0mPOST /api/user/updateUser [32m200[0m 9.581 ms - 664[0m
    âœ” should update user's own property email
[0mPOST /api/user/updateUser [32m200[0m 9.359 ms - 664[0m
    âœ” should update user's own property lastName
[0mPOST /api/user/updateUser [32m200[0m 8.678 ms - 664[0m
    âœ” should update user's own property fiscalCode
[0mPOST /api/user/updateUser [32m200[0m 6.660 ms - 664[0m
    âœ” should update user's own property businessName
[0mPOST /api/user/updateUser [32m200[0m 4.668 ms - 634[0m
    âœ” should update user's own property address
[0mPOST /api/user/updateRoles [33m400[0m 1.245 ms - 46[0m
    âœ” should not update user's own roles without any role
[0mPOST /api/user/updateRoles [33m400[0m 1.401 ms - 46[0m
    âœ” should not update user's own roles with not array roles
[0mPOST /api/user/updateRoles [33m400[0m 0.828 ms - 46[0m
    âœ” should not update user's own roles with empty array roles
[0mPOST /api/user/updateRoles [32m200[0m 8.044 ms - 41[0m
    âœ” should update (equal or downgrade) user's own roles without admin access 
[0mPOST /api/user/updateRoles [33m403[0m 7.292 ms - 59[0m
    âœ” should not update user's own roles without admin access (upgrade)
[0mPOST /api/user/updateRoles [32m200[0m 5.510 ms - 41[0m
    âœ” should update user's own roles as admin user (upgrade)
[0mPOST /api/user/updateRoles [33m403[0m 3.488 ms - 113[0m
    âœ” should not update another user's roles without admin access
[0mPOST /api/user/updateRoles [32m200[0m 7.365 ms - 41[0m
    âœ” should update another user's roles with admin access
[0mPOST /api/user/updatePlan [33m400[0m 2.935 ms - 31[0m
    âœ” should not update user's our plan with no plan
[0mPOST /api/user/updatePlan [33m400[0m 4.431 ms - 27[0m
    âœ” should not update user's our plan with wrong plan
[0mPOST /api/user/updatePlan [33m403[0m 2.797 ms - 67[0m
    âœ” should not update user's own plan without admin access
[0mPOST /api/user/updatePlan [33m403[0m 2.263 ms - 67[0m
    âœ” should not update user's own plan (even the free plan)
[0mPOST /api/user/updatePlan [33m400[0m 4.286 ms - 27[0m
    âœ” should not update another user's plan with admin access
[0mPOST /api/user/updatePlan [33m403[0m 2.389 ms - 67[0m
    âœ” should not update (upgrade) user's own plan without admin access
[0mPOST /api/user/updatePlan [32m200[0m 5.528 ms - 395[0m
    âœ” should update user's own plan as admin user (upgrade)
[0mPOST /api/user/updatePlan [33m403[0m 3.102 ms - 67[0m
    âœ” should not update another user's plan without admin access
[0mPOST /api/user/updatePlan [32m200[0m 8.150 ms - 395[0m
    âœ” should update another user's plan with admin access
[0mGET /api/user/getAllUsers [33m403[0m 2.293 ms - 67[0m
    âœ” should not get all users with user role
[0mGET /api/user/getAllUsers [33m400[0m 3.292 ms - 40[0m
    âœ” should not get all users with wrong filter
[0mGET /api/user/getAllUsers [32m200[0m 5.384 ms - 961[0m
    âœ” should get all users with admin role
[0mPOST /api/user/deleteUser [33m401[0m 0.464 ms - 101[0m
    âœ” should not delete user without authentication
[0mPOST /api/user/deleteUser [33m403[0m 2.590 ms - 67[0m
    âœ” should not delete user without admin privileges
[0mPOST /api/user/deleteUser [33m400[0m 3.794 ms - 39[0m
    âœ” should not delete user with admin privileges using invalid id
[0mPOST /api/user/deleteUser [32m200[0m 4.641 ms - 51[0m
    âœ” should delete user with admin privileges using id
[0mPOST /api/user/deleteUser [32m200[0m 4.355 ms - 51[0m
    âœ” should delete user with admin privileges using email
hashPassword, salt: $2a$10$V/TjXx3MgrbvN.h6kUvOG.
[0mPOST /api/auth/signup [32m201[0m 63.988 ms - 145[0m
[0mPOST /api/auth/signupVerification [32m200[0m 3.883 ms - 63[0m
    âœ” should register normal user (71ms)
[0mPOST /api/auth/signin [32m200[0m 61.547 ms - 513[0m
    âœ” should login normal user (62ms)
hashPassword, salt: $2a$10$UQhDddkZLt.tHrUmwY3UkO
[0mPOST /api/auth/signup [32m201[0m 59.573 ms - 147[0m
[0mPOST /api/auth/signupVerification [32m200[0m 3.481 ms - 63[0m
    âœ” should register admin user (65ms)
[0mPOST /api/auth/signin [32m200[0m 58.671 ms - 532[0m
    âœ” should login as admin user (60ms)
[0mPOST /api/user/removeUser [33m401[0m 0.486 ms - 101[0m
    âœ” should not remove user without authentication
[0mPOST /api/user/removeUser [33m403[0m 2.322 ms - 67[0m
    âœ” should not remove user without admin privileges
[0mPOST /api/user/removeUser [33m400[0m 4.816 ms - 39[0m
    âœ” should not remove user with admin privileges using invalid id
[0mPOST /api/user/removeUser [32m200[0m 3.467 ms - 51[0m
    âœ” should remove user with admin privileges using id
[0mPOST /api/user/removeUser [32m200[0m 3.776 ms - 51[0m
    âœ” should remove user with admin privileges using email
[0mPOST /api/user/removeUser [32m200[0m 4.145 ms - 51[0m
    âœ” should remove all users with admin privileges

  API tests - Helpers - Environment
    âœ” should not assert environment with no environment
    âœ” should not assert environment with missing required variable
    âœ” should assert environment with default environment

  API tests - Plan model
    âœ” plan model should accept any value different by -1 ("unlimited")
    âœ” plan model should convert -1 ("unlimited") value to a number (MAX_SAFE_INTEGER)

  API tests - Server
[0mPOST /api/not-found-route [33m404[0m 0.624 ms - 23[0m
    âœ” should correctly handle not found route


  117 passing (6s)

