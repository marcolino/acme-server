"use strict";(self.webpackChunkacme_client=self.webpackChunkacme_client||[]).push([[310],{2310:(e,a,s)=>{s.r(a),s.d(a,{default:()=>S});var r=s(402),l=s(7282),t=s(7847),n=s(1619),o=s(7758),c=s(2209),i=s(3567),d=s(1919),u=s(5253);const m=(0,u.A)(r.createElement("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person"),h=(0,u.A)(r.createElement("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"}),"Email"),v=(0,u.A)(r.createElement("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"}),"Phone"),p=(0,u.A)(r.createElement("path",{d:"M11.99 2c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm3.61 6.34c1.07 0 1.93.86 1.93 1.93 0 1.07-.86 1.93-1.93 1.93-1.07 0-1.93-.86-1.93-1.93-.01-1.07.86-1.93 1.93-1.93zm-6-1.58c1.3 0 2.36 1.06 2.36 2.36 0 1.3-1.06 2.36-2.36 2.36s-2.36-1.06-2.36-2.36c0-1.31 1.05-2.36 2.36-2.36zm0 9.13v3.75c-2.4-.75-4.3-2.6-5.14-4.96 1.05-1.12 3.67-1.69 5.14-1.69.53 0 1.2.08 1.9.22-1.64.87-1.9 2.02-1.9 2.68zM11.99 20c-.27 0-.53-.01-.79-.04v-4.07c0-1.42 2.94-2.13 4.4-2.13 1.07 0 2.92.39 3.84 1.15-1.17 2.97-4.06 5.09-7.45 5.09z"}),"SupervisedUserCircle"),A=(0,u.A)(r.createElement("path",{d:"M14 10H2v2h12v-2zm0-4H2v2h12V6zM2 16h8v-2H2v2zm19.5-4.5L23 13l-6.99 7-4.51-4.5L13 14l3.01 3 5.49-5.5z"}),"PlaylistAddCheck"),f=(0,u.A)(r.createElement("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"}),"LocationOn"),E=(0,u.A)(r.createElement("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"}),"Payment"),g=(0,u.A)(r.createElement("path",{d:"M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"}),"Business");var P=s(9785),_=s(2335),N=s(2704),x=s(6094),R=s(9509),z=s(6749),L=s(8058);const j=(0,o.A)((e=>({fieldset:{border:0}})));function I(e){var a,s;const o=j(),u=(0,l.W6)(),I=null===e||void 0===e||null===(a=e.match)||void 0===a||null===(s=a.params)||void 0===s?void 0:s.userId,[S,C]=(0,r.useState)(!1),[k,H]=(0,r.useState)({}),{auth:V,setAuth:b}=(0,r.useContext)(x.c),{promiseInProgress:M}=(0,t.H8)({delay:z.A.spinner.delay}),{t:w}=(0,n.B)(),[O,U]=r.useState(!1),[y,T]=r.useState(!1),[F,Y]=(0,r.useState)(!1);if(!I)return N.o.error(w("No user id specified")),void u.goBack();(0,r.useEffect)((()=>{F&&(Y(!1),B())}),[F]),(0,r.useEffect)((()=>{(0,_.L_)().then((e=>{if(!e.ok)return console.warn("getAllRoles error:",e),void(e.message&&N.o.error(w(e.message)));U(e.roles),console.log("getAllRoles success:",e)}))}),[w]),(0,r.useEffect)((()=>{(0,_.Wh)().then((e=>{if(!e.ok)return console.warn("getAllPlans error:",e),void(e.message&&N.o.error(w(e.message)));T(e.plans),console.log("getAllPlans success:",e)}))}),[w]),(0,r.useEffect)((()=>{(0,_.wz)({userId:I}).then((e=>{if(!e.ok)return console.warn("getUser error:",e),void(e.message&&N.o.error(w(e.message)));C(e.user),console.log("getUser success:",e)}))}),[w]);const B=e=>{(0,_.TK)({userId:I,...S}).then((e=>{if(!e.ok)return console.warn("updateUser error:",e),N.o.error(w(e.message)),void H({});if(console.log("updateUser success:",e.user),V.user.id===e.user._id){const a=V.user;a.email=e.user.email,a.firstName=e.user.firstName,a.lastName=e.user.lastName,console.log(" *** updated user ***:",e.user),b({user:a})}u.goBack()})).catch((e=>{console.error("updateUser error catched:",e),N.o.error(w(e.message)),H({})}))};return S?O?y?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(P.zE,{children:w("Edit user")}),(0,L.jsx)(c.A,{maxWidth:"xs",children:(0,L.jsx)("form",{className:o.form,noValidate:!0,autoComplete:"off",children:(0,L.jsxs)("fieldset",{disabled:M,className:o.fieldset,children:[(0,L.jsx)(i.A,{m:2}),(0,L.jsx)(P.ZQ,{autofocus:!0,id:"firstName",value:S.firstName,onChange:e=>{return a=e.target.value,void C({...S,firstName:a});var a},placeholder:w("First Name"),startAdornmentIcon:(0,L.jsx)(m,{}),error:k.firstName}),(0,L.jsx)(P.ZQ,{id:"lastName",value:S.lastName,onChange:e=>{return a=e.target.value,void C({...S,lastName:a});var a},placeholder:w("Last Name"),startAdornmentIcon:(0,L.jsx)(m,{}),error:k.lastName}),(0,L.jsx)(P.ZQ,{id:"email",value:S.email,onChange:e=>{return a=e.target.value,void C({...S,email:a});var a},placeholder:w("Email"),startAdornmentIcon:(0,L.jsx)(h,{}),error:k.email}),(0,L.jsx)(P.rW,{id:"phone",value:S.phone,onChange:e=>{return a=e.target.value,void C({...S,phone:a});var a},placeholder:w("Phone"),startAdornmentIcon:(0,L.jsx)(v,{}),error:k.phone}),(0,L.jsx)(P.FX,{id:"roles",value:S.roles.map((e=>e.name)),options:O.map((e=>e.name)),multiple:!0,onChange:e=>(e=>{const a=O.filter((a=>e.includes(a.name)));C({...S,roles:a})})(e.target.value),placeholder:w("Roles"),startAdornmentIcon:(0,L.jsx)(p,{}),error:k.roles}),z.A.ui.usePlans&&(0,L.jsx)(P.FX,{id:"plan",value:S.plan.name,options:y.map((e=>e.name)),multiple:!1,onChange:e=>(e=>{const a=y.find((a=>e===a.name));C({...S,plan:a})})(e.target.value),placeholder:w("Plan"),startAdornmentIcon:(0,L.jsx)(A,{}),error:k.plan}),(0,L.jsx)(P.ZQ,{id:"address",value:S.address,onChange:e=>{return a=e.target.value,void C({...S,address:a});var a},placeholder:w("Address"),startAdornmentIcon:(0,L.jsx)(f,{}),error:k.address}),(0,L.jsx)(P.ZQ,{id:"fiscalCode",value:S.fiscalCode,onChange:e=>{return a=e.target.value,void C({...S,fiscalCode:a});var a},placeholder:w("Tax Code or VAT Number"),startAdornmentIcon:(0,L.jsx)(E,{}),error:k.address}),(0,L.jsx)(P.ZQ,{id:"businessName",value:S.businessName,onChange:e=>{return a=e.target.value,void C({...S,businessName:a});var a},placeholder:w("Business name"),startAdornmentIcon:(0,L.jsx)(g,{}),error:k.businessName}),(0,L.jsx)(i.A,{m:2}),(0,L.jsx)(P.pr,{onClick:e=>{e.preventDefault(),(()=>{let e;if(e=(0,R.u4)(S.firstName),!0!==e){let a;switch(e){case"ERROR_PLEASE_SUPPLY_A_FIRSTNAME":a=w("Please supply a first name");break;case"ERROR_PLEASE_SUPPLY_A_VALID_FIRSTNAME":a=w("Please supply a valid first name");break;default:a=e}return H({firstName:a}),N.o.warning(a),!1}if(e=(0,R.gF)(S.lastName),!0!==e){let a;switch(e){case"ERROR_PLEASE_SUPPLY_A_LASTNAME":a=w("Please supply a last name");break;case"ERROR_PLEASE_SUPPLY_A_VALID_LASTNAME":a=w("Please supply a valid last name");break;default:a=e}return H({lastName:a}),N.o.warning(a),!1}if(e=(0,R.DT)(S.email),!0!==e){let a;switch(e){case"ERROR_PLEASE_SUPPLY_AN_EMAIL":a=w("Please supply an email");break;case"ERROR_PLEASE_SUPPLY_A_VALID_EMAIL":a=w("Please supply a valid email");break;default:a=e}return H({email:a}),N.o.warning(a),!1}if(e=(0,R.FY)(S.phone),!0!==e){let a,s,r;switch(e){case"ERROR_PLEASE_SUPPLY_A_PHONE_NUMBER":a=w("Please supply a phone");break;case"ERROR_PLEASE_SUPPLY_A_VALID_PHONE":a=w("Please supply a valid phone");break;case"WARNING_NO_INTERNATIONAL_PREFIX":return s=S.phone,r=`${z.A.i18n.phonePrefix} ${s}`,C({...S,phone:r}),!0;case"WARNING_ZERO_INTERNATIONAL_PREFIX":const l=/(^00\s?)/,t="+";return s=S.phone,r=s.replace(l,t),C({...S,phone:r}),!0;default:a=e}return H({email:a}),N.o.warning(a),!1}return!0})()&&(Y(!0),H({}))},children:w("Confirm")}),(0,L.jsx)(d.A,{container:!0,justifyContent:"flex-end",children:(0,L.jsx)(P.pr,{onClick:e=>{e.preventDefault(),H({}),u.goBack()},fullWidth:!1,className:"buttonSecondary",children:w("Cancel")})})]})})})]}):(0,L.jsx)("p",{children:" loading all plans... "}):(0,L.jsx)("p",{children:" loading all roles... "}):(0,L.jsx)("p",{children:" loading user... "})}const S=r.memo(I)}}]);
//# sourceMappingURL=310.05dc753d.chunk.js.map