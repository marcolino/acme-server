"use strict";(self.webpackChunkacme_client=self.webpackChunkacme_client||[]).push([[448],{3448:(e,n,r)=>{r.r(n),r.d(n,{default:()=>l});var s=r(402),o=r(7282),t=r(1619),c=r(8634),i=r(6094),a=r(5560),u=r(2704);function h(){const e=(0,o.W6)(),n=(0,s.useContext)(a.h),{auth:r,setAuth:h}=(0,s.useContext)(i.c),{t:l}=(0,t.B)();return(0,s.useEffect)((()=>{n?(0,c.CI)({success:()=>{console.log("SETAUTH {user: false}:"),h({user:!1}),e.replace("/")},error:e=>{console.error("signOut error:",e),u.o.error(l(e.message))}}):(console.log("SETAUTH {user: false}:"),h({user:!1}),e.replace("/"))}),[n,e,r,h,l]),null}const l=s.memo(h)},8634:(e,n,r)=>{r.d(n,{Mg:()=>h,CI:()=>l,Hh:()=>a,Yw:()=>u});var s=r(7847),o=r(6749);const t={signUp:e=>c("/api/auth/signup","POST",e),signupVerification:e=>c("/api/auth/signupVerification","POST",e),resendSignup:e=>c("/api/auth/resendSignupCode","POST",e),signIn:e=>c("/api/auth/signin","POST",e),signOut:e=>new Promise(((e,n)=>{e()}))},c=(e,n,r)=>(console.log("fetcher:",e,n,r),new Promise(((s,t)=>{"GET"===n&&r&&(e+="?"+Object.keys(r).map((e=>encodeURIComponent(e)+"="+encodeURIComponent(r[e]))).join("&"));new Headers(o.A.api.headers),r&&"GET"!==n&&JSON.stringify(r),o.A.api.redirect;fetch(e,{method:n,headers:new Headers(o.A.api.headers),...r&&"GET"!==n&&{body:JSON.stringify(r)},redirect:o.A.api.redirect}).then((n=>n.ok?n.json():n.json().then((n=>{console.error(`auth fetch ${e} response error, data:`,n);const r=n.message?n.message:n.error?n.error:"unknown error";t(new Error(r))})))).then((n=>{console.info(`auth fetch ${e} success:`,n),s(n)})).catch((n=>{console.error(`auth fetch ${e} error:`,n),t(n)}))}))),i=t;function a(e,n){let{success:r,error:o,final:t}=n;(0,s.$h)(i.signUp({...e}).then((e=>r(e))).catch((e=>o(e))).finally((e=>t(e))))}function u(e,n){let{success:r,error:o,final:t}=n;console.log("TrackPromise - props:",e),(0,s.$h)(i.signupVerification({...e}).then((e=>r(e))).catch((e=>o(e))).finally((e=>t(e))))}function h(e,n){let{success:r,error:o,final:t}=n;(0,s.$h)(i.resendSignup(e).then((e=>r(e))).catch((e=>o(e))).finally((e=>t(e))))}function l(e){let{success:n,error:r,final:o}=e;(0,s.$h)(i.signOut().then((e=>n(e))).catch((e=>r(e))).finally((e=>o(e))))}}}]);
//# sourceMappingURL=448.f1d5363f.chunk.js.map