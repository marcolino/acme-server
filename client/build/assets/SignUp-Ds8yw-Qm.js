import{a as se,j as e,R as re,b as oe,r as o,d as B,A as ie,e as ne,u as le,B as l,c as x,T as d,C as g,L as R,G as ce,D as de,f as ue,g as me,h as fe,i as _,v as ge,k as pe,l as xe,m as he}from"./index-RKOwH3L5.js";import{S as h}from"./TextField-BuG7cnXz.js";import{T as $,L as H}from"./TextFieldPassword-CC09HB0c.js";import{A as ye}from"./Avatar-B_ktiCG4.js";import{P as X}from"./Person-C5BLu2CY.js";import{E as Se}from"./Email-DJ3uIJaq.js";import{G as Ce,F as Pe}from"./Google-B1fJ1iff.js";import{C as je}from"./ConfirmationNumber-Cw0UM5oe.js";import"./Select-HLbkRNVN.js";const Ee=se([e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M7.35 18.5C8.66 17.56 10.26 17 12 17s3.34.56 4.65 1.5c-1.31.94-2.91 1.5-4.65 1.5s-3.34-.56-4.65-1.5m10.79-1.38C16.45 15.8 14.32 15 12 15s-4.45.8-6.14 2.12C4.7 15.73 4 13.95 4 12c0-4.42 3.58-8 8-8s8 3.58 8 8c0 1.95-.7 3.73-1.86 5.12"},"0"),e.jsx("path",{d:"M12 6c-1.93 0-3.5 1.57-3.5 3.5S10.07 13 12 13s3.5-1.57 3.5-3.5S13.93 6 12 6m0 5c-.83 0-1.5-.67-1.5-1.5S11.17 8 12 8s1.5.67 1.5 1.5S12.83 11 12 11"},"1")],"AccountCircleOutlined");function Ae(){const v=oe(),[y,b]=o.useState(""),[S,D]=o.useState(""),[f,L]=o.useState(""),[C,F]=o.useState(""),[I,z]=o.useState(""),{waitingForCode:O}=B(),[c,k]=o.useState(O||!1),{codeDeliveryMedium:N}=B(),[T,M]=o.useState(N||""),[P,U]=o.useState(""),[u,i]=o.useState({}),[q,j]=o.useState(!1),[J,V]=o.useState(null),[K,G]=o.useState(null),[W,E]=o.useState(null),{cloneGuestUserPreferencesToAuthUserOnSignup:Q}=o.useContext(ie),{showSnackbar:n}=ne(),{t:a}=le();console.log("waitingForCodeFromParams, waitingForCode:",O,c),console.log("codeDeliveryMediumFromParams, codeDeliveryMedium:",N,T);const Z=(s,t)=>{s.preventDefault(),window.location.replace(`${x.siteUrl}/api/auth/${t.toLowerCase()}`)},A=(s,t,r)=>{V(s),G(t),E(()=>r),j(!0)},Y=()=>{j(!1),W&&(E(null),W())},w=s=>{let t;if(!c){if(t=ge(y),t!==!0){let r;switch(t){case"ERROR_PLEASE_SUPPLY_A_FIRSTNAME":r=a("Please supply first name");break;case"ERROR_PLEASE_SUPPLY_A_VALID_FIRSTNAME":r=a("Please supply a valid first name");break;default:r=t}return i({firstName:!0}),n(r,"warning"),!1}if(t=pe(S),t!==!0){let r;switch(t){case"ERROR_PLEASE_SUPPLY_A_LASTNAME":r=a("Please supply last name");break;case"ERROR_PLEASE_SUPPLY_A_VALID_LASTNAME":r=a("Please supply a valid last name");break;default:r=t}return i({lastName:!0}),n(r,"warning"),!1}}if((!c||s!=null&&s.waitingForCodeResend)&&(t=xe(f),t!==!0)){let r;switch(t){case"ERROR_PLEASE_SUPPLY_AN_EMAIL":r=a("Please supply an email");break;case"ERROR_PLEASE_SUPPLY_A_VALID_EMAIL":r=a("Please supply a valid email");break;default:r=t}return i({email:!0}),n(r,"warning"),!1}if(!c){const[r,p]=he(C,I);if(r!==!0){let m;switch(r){case"ERROR_PLEASE_SUPPLY_A_PASSWORD":m=a("Please supply a password");break;case"ERROR_PLEASE_SUPPLY_A_MORE_COMPLEX_PASSWORD":m=a("Please supply a more complex password")+`.

`+p;break;case"PLEASE_CONFIRM_THE_PASSWORD":m=a("Please confirm the password");break;case"ERROR_THE_CONFIRMED_PASSWORD_DOES_NOT_MATCH_THE_PASSWORD":m=a("The confirmed password does not match the password");break;default:m=r}return i({password:!0}),n(m,"warning"),!1}return!0}return c&&!(s!=null&&s.waitingForCodeResend)&&P.length<=0?(i({code:!0}),!1):!0},ee=async s=>{var r;if(s.preventDefault(),!w())return;i({});const t=await _("post","/auth/signup",{email:f,password:C,firstName:y,lastName:S});if(t.err)switch((r=t.data)==null?void 0:r.code){case"ACCOUNT_WAITING_FOR_VERIFICATION":i({email:!0}),V(a("Account is waiting for verification")),G(t.data.message),E(()=>{k(!0)}),j(!0);break;case"EMAIL_EXISTS_ALREADY":case"ACCOUNT_DELETED":i({email:!0}),n(t.message,"warning");break;default:i({}),n(t.message,"error")}else{console.devAlert(`SIGNUP VERIFICATION CODE: ${t.code}`),k(!0),b(""),D(""),F("");const p=t.codeDeliveryMedium;M(p),A(a("Confirmation code sent by {{medium}}",{medium:p}),t.message,()=>{})}},te=async s=>{if(s.preventDefault(),!w())return;i({});const t=await _("post","/auth/signupVerification",{email:f,code:P});t.err?(n(t.message,"error"),i({code:!0})):(L(""),U(""),Q(),A(a("Registered successfully"),t.message,()=>{v("/signin",{replace:!0})}))},ae=async s=>{if(s.preventDefault(),!w({waitingForCodeResend:!0}))return;i({});const t=await _("post","/auth/resendSignupVerificationCode",{email:f});if(t.err)n(t.message,"error"),i({code:!0});else{console.devAlert(`SIGNUP VERIFICATION CODE: ${t.code}`);const r=t.codeDeliveryMedium;M(r),A(a("Confirmation code resent by {{medium}}",{medium:r}),t.message,()=>{})}};return e.jsxs("form",{noValidate:!0,autoComplete:"on",children:[e.jsx(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"start",mt:6},children:e.jsxs(l,{sx:{width:"100%",maxWidth:400,p:2,border:"1px solid",borderColor:"primary.main",borderRadius:4},children:[e.jsx(l,{sx:{display:"flex",justifyContent:"center",mt:0,mb:3},children:e.jsx(ye,{sx:{backgroundColor:"primary.main"},children:e.jsx(Ee,{})})}),!c&&e.jsxs(e.Fragment,{children:[e.jsx(d,{variant:"body1",color:"textSecondary",sx:{display:"flex",justifyContent:"center",my:1},children:a("Register with your data")}),e.jsx(h,{autoFocus:!0,id:"firstName",value:y,onChange:s=>b(s.target.value),placeholder:a("First Name"),startIcon:e.jsx(X,{}),error:u.firstName}),e.jsx(h,{id:"lastName",value:S,onChange:s=>D(s.target.value),placeholder:a("Last Name"),startIcon:e.jsx(X,{}),error:u.lastName}),e.jsx(h,{id:"email",value:f,onChange:s=>L(s.target.value),placeholder:a("Email"),startIcon:e.jsx(Se,{}),error:u.email}),e.jsx($,{id:"password",type:"password",value:C,onChange:s=>F(s.target.value),placeholder:a("Password"),startIcon:e.jsx(H,{}),autoComplete:"password",error:u.password}),e.jsx($,{id:"passwordConfirmed",type:"password",value:I,onChange:s=>z(s.target.value),placeholder:a("Password confirmation"),startIcon:e.jsx(H,{}),autoComplete:"password-confirmation",error:u.passwordConfirmed}),e.jsx(l,{m:1}),e.jsx(g,{type:"submit",onClick:ee,sx:{mt:1,textAlign:"center"},children:a("Sign Up")}),e.jsx(l,{sx:{display:"flex",justifyContent:"center",mt:2},children:e.jsxs(d,{variant:"body2",color:"textSecondary",children:[a("Already have an account?")," ",e.jsxs(R,{style:{cursor:"pointer"},underline:"hover",onClick:()=>v("/signin"),children:[a("Sign in"),"!"]})]})}),x.oauth.federatedSigninProviders.length&&e.jsxs(l,{children:[e.jsx(d,{variant:"body2",color:"textSecondary",sx:{display:"flex",justifyContent:"center",my:3},children:a("or")}),e.jsx(d,{variant:"body2",color:"textSecondary",sx:{display:"flex",justifyContent:"center",my:1},children:a("Sign in with a social account")}),e.jsx(l,{display:"flex",flexDirection:"row",children:x.oauth.federatedSigninProviders.map((s,t)=>e.jsx(g,{startIcon:s==="Google"?e.jsx(Ce,{sx:{color:"red"}}):s==="Facebook"?e.jsx(Pe,{sx:{color:"blue"}}):e.jsx(Icon,{sx:{backgroundColor:"white",color:"red"},children:"G"}),sx:{mr:t<x.oauth.federatedSigninProviders.length-1?1:0},type:s==="Google"?"socialAuthButtonGoogle":s==="Facebook"?"socialAuthButtonFacebook":"",onClick:r=>Z(r,s),children:s},s))})]}),e.jsx(ce,{container:!0,justifyContent:"flex-start",sx:{mt:4},children:e.jsxs(d,{component:"h6",variant:"caption",color:"textSecondary",align:"center",children:[a("By signing up")," ",a("you agree to our")," ",e.jsx(R,{href:"/terms-of-use",color:"textPrimary",children:a("terms of use")})," "," ",a("and you confirm you have read our")," ",e.jsx(R,{href:"/privacy-policy",color:"textPrimary",children:a("privacy policy")}),", "," ",a("including cookie use")," ","."]})})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx(d,{variant:"body1",color:"textSecondary",sx:{display:"flex",justifyContent:"center",my:1},children:a("Verify Sign Up")}),e.jsx(h,{id:"signUpCode",type:"tel",value:P,onChange:s=>U(s.target.value),placeholder:a("Numeric code received by {{codeDeliveryMedium}}",{codeDeliveryMedium:T}),startIcon:e.jsx(je,{}),error:u.code}),e.jsx(l,{m:1}),e.jsx(g,{type:"submit",onClick:te,children:a("Verify Sign Up")}),e.jsx(g,{onClick:ae,fullWidth:!1,size:"small",color:"tertiary",sx:{float:"right",marginLeft:"auto",marginRight:0,mt:1},children:a("Resend code")})]})]})}),e.jsxs(de,{open:q,onClose:Y,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ue,{id:"alert-dialog-title",children:J}),e.jsx(me,{id:"alert-dialog-description",children:e.jsx(d,{variant:"body1",sx:{whiteSpace:"pre-line"},children:K})}),e.jsx(fe,{children:e.jsx(g,{onClick:Y,fullWidth:!1,autoFocus:!0,children:a("Ok")})})]})]})}const Oe=re.memo(Ae);export{Oe as default};
