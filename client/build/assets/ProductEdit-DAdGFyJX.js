import{c as h,a as p,au as T,j as t,aw as oe,T as ae,R as ie,b as re,r as d,A as me,e as ce,u as le,d as ne,k as g,dn as ue,B as b,G as P,C as D,f as S}from"./index-DQQjlUOR.js";import{S as de}from"./Select-CM1JWUez.js";import{S as u}from"./TextField-BTSCA2Mp.js";import{I as M}from"./ImageContainer-DuZqX4kn.js";import"./Select-B3vUW_kL.js";const L=h(p.jsx("path",{d:"m14 12-2 2-2-2 2-2zm-2-6 2.12 2.12 2.5-2.5L12 1 7.38 5.62l2.5 2.5zm-6 6 2.12-2.12-2.5-2.5L1 12l4.62 4.62 2.5-2.5zm12 0-2.12 2.12 2.5 2.5L23 12l-4.62-4.62-2.5 2.5zm-6 6-2.12-2.12-2.5 2.5L12 23l4.62-4.62-2.5-2.5z"}),"Api"),pe=h(p.jsx("path",{d:"M4 8h4V4H4zm6 12h4v-4h-4zm-6 0h4v-4H4zm0-6h4v-4H4zm6 0h4v-4h-4zm6-10v4h4V4zm-6 4h4V4h-4zm6 6h4v-4h-4zm0 6h4v-4h-4z"}),"Apps"),he=h(p.jsx("path",{d:"M12 4H5C3.34 4 2 5.34 2 7v8c0 1.66 1.34 3 3 3l-1 1v1h1l2-2.03L9 18v-5H4V5.98L13 6v2h2V7c0-1.66-1.34-3-3-3M5 14c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m15.57-4.34c-.14-.4-.52-.66-.97-.66h-7.19c-.46 0-.83.26-.98.66L10 13.77l.01 5.51c0 .38.31.72.69.72h.62c.38 0 .68-.38.68-.76V18h8v1.24c0 .38.31.76.69.76h.61c.38 0 .69-.34.69-.72l.01-1.37v-4.14zm-8.16.34h7.19l1.03 3h-9.25zM12 16c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m8 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"Commute"),xe=h(p.jsx("path",{d:"M18.92 5.01C18.72 4.42 18.16 4 17.5 4h-11c-.66 0-1.21.42-1.42 1.01L3 11v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8zM6.5 15c-.83 0-1.5-.67-1.5-1.5S5.67 12 6.5 12s1.5.67 1.5 1.5S7.33 15 6.5 15m11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5M5 10l1.5-4.5h11L19 10z"}),"DriveEta"),fe=h(p.jsx("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote"),Ne=h(p.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M6 7h5v1.5H6zm13 12H5L19 5zm-4.5-3v2H16v-2h2v-1.5h-2v-2h-1.5v2h-2V16z"}),"Exposure"),ge=h([p.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),p.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"PhotoCamera"),be=h(p.jsx("path",{d:"M16.01 7 16 3h-2v4h-4V3H8v4h-.01C7 6.99 6 7.99 6 8.99v5.49L9.5 18v3h5v-3l3.5-3.51v-5.5c0-1-1-2-1.99-1.99"}),"Power"),je=h(p.jsx("path",{d:"M17.41 6.59 15 5.5l2.41-1.09L18.5 2l1.09 2.41L22 5.5l-2.41 1.09L18.5 9zm3.87 6.13L20.5 11l-.78 1.72-1.72.78 1.72.78.78 1.72.78-1.72L23 13.5zm-5.04 1.65 1.94 1.47-2.5 4.33-2.24-.94c-.2.13-.42.26-.64.37l-.3 2.4h-5l-.3-2.41c-.22-.11-.43-.23-.64-.37l-2.24.94-2.5-4.33 1.94-1.47c-.01-.11-.01-.24-.01-.36s0-.25.01-.37l-1.94-1.47 2.5-4.33 2.24.94c.2-.13.42-.26.64-.37L7.5 6h5l.3 2.41c.22.11.43.23.64.37l2.24-.94 2.5 4.33-1.94 1.47c.01.12.01.24.01.37s0 .24-.01.36M13 14c0-1.66-1.34-3-3-3s-3 1.34-3 3 1.34 3 3 3 3-1.34 3-3"}),"SettingsSuggest"),ve=h(p.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"}),"Sync"),Ee=h(p.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"}),"TurnedInNotOutlined"),Ce=oe("div")(({theme:N})=>({position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center"}));function y({iconSize:N=1.6,textSize:o=.6,text:a="",iconProps:i={},countProps:j={}}){const v=T();return t.jsxDEV(Ce,{children:[t.jsxDEV(be,{sx:{fontSize:N+"em",...i.sx},...i},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/glyphs/PowerWithText.jsx",lineNumber:23,columnNumber:7},this),t.jsxDEV(ae,{component:"span",sx:{position:"absolute",lineHeight:1,color:v.palette.background.default,top:o*1.5+"em",fontSize:o+"em!important",...j.sx},...j,children:a},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/glyphs/PowerWithText.jsx",lineNumber:30,columnNumber:7},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/glyphs/PowerWithText.jsx",lineNumber:22,columnNumber:5},this)}function Ve(){const N=re();T();const[o,a]=d.useState(!1),[i,j]=d.useState(!1),[v,A]=d.useState([]),[c,I]=d.useState({}),{auth:O}=d.useContext(me),{showSnackbar:x}=ce(),{t:s}=le(),{productId:f}=ne();if(!f){x(s("No product id specified"),"error"),N(-1);return}const[z,k]=d.useState(!1),[E,H]=d.useState(null),[C,R]=d.useState(null),[m,l]=d.useState({});d.useEffect(()=>{O.user&&(async()=>{const e=await g("post","/product/getProductAllTypes");e.err?x(e.message,e.status===401?"warning":"error"):A(e.types)})()},[]);const W=e=>{e.target.files.length>1&&x(s("More than one image selected, using the first one"),"info");const r=e.target.files[0];r&&(H(r),R(URL.createObjectURL(r)),w(r.name))};d.useEffect(()=>{(async()=>{if(f==="<new>")console.log("NEW PRODUCT"),a({mdaCode:"",oemCode:"",make:"",models:[],application:"",kw:"",volt:"",ampere:"",teeth:"",rotation:"",regulator:"",type:"",imageNameOriginal:"",imageName:"",notes:""});else{const e=await g("post","/product/getProduct",{productId:f});e.err?x(e.message,e.status===401?"warning":"error"):(a(e.product),j(e.product))}})()},[f]),d.useEffect(()=>{z&&(k(!1),te())},[z]);const U=e=>{a({...o,type:e}),l({...m,type:e!=i.type})},F=e=>{a({...o,mdaCode:e}),l({...m,mdaCode:e!=i.mdaCode})},$=e=>{a({...o,oemCode:e}),l({...m,oemCode:e!=i.oemCode})},B=e=>{a({...o,make:e}),l({...m,make:e!=i.make})},G=e=>{a({...o,models:e.split(", ")}),l({...m,models:e!=i.models})},K=e=>{a({...o,application:e}),l({...m,application:e!=i.application})},q=e=>{a({...o,kw:e}),l({...m,kw:e!=i.kw})},J=e=>{a({...o,volt:e}),l({...m,volt:e!=i.volt})},Q=e=>{a({...o,ampere:e}),l({...m,ampere:e!=i.ampere})},X=e=>{a({...o,rotation:e}),l({...m,rotation:e!=i.rotation})},Y=e=>{a({...o,teeth:e}),l({...m,teeth:e!=i.teeth})},Z=e=>{a({...o,regulator:e}),l({...m,regulator:e!=i.regulator})},_=e=>{a({...o,notes:e}),l({...m,notes:e!=i.notes})},w=e=>{a({...o,imageNameOriginal:e}),l({...m,imageNameOriginal:e!=i.imageNameOriginal})},ee=e=>{e.preventDefault(),k(!0),I({})},te=async()=>{try{let e,r;if(f==="<new>"?(r=await g("post","/product/insertProduct",{product:o}),e=r.id):(r=await g("post","/product/updateProduct",{productId:f,product:o}),e=f),r.err)return x(r.message,"error");if(E){const V=new FormData;if(V.append("productId",e),V.append("image",E),r=await g("post","/product/uploadProductImage",V),r.err)return r.message==="Input buffer contains unsupported image format"&&(r.message=s("Image format unsupported")),x(r.message,"error")}N(-1)}catch(e){x(`An error occurred updating the product: ${e.message}`,"error"),console.error(e)}},se=e=>{e.preventDefault(),I({}),N(-1)},n=e=>{const r={fontWeight:m[e]?"bold":"normal"};return{...r,input:r}};if(o&&v.length)return t.jsxDEV(t.Fragment,{children:[t.jsxDEV(ue,{text:s("Products handling"),children:s("Edit product")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:265,columnNumber:9},this),t.jsxDEV(b,{sx:{display:"flex",justifyContent:"center",alignItems:"start",minHeight:"100vh"},children:t.jsxDEV(P,{container:!0,spacing:2,maxWidth:800,children:[t.jsxDEV(P,{item:!0,xs:12,sm:6,children:t.jsxDEV(b,{display:"flex",flexDirection:"column",gap:2,children:t.jsxDEV("form",{noValidate:!0,autoComplete:"off",children:[t.jsxDEV(u,{autoFocus:!0,id:"mdaCode",label:s("MDA code"),value:o.mdaCode??"",onChange:e=>F(e.target.value),placeholder:s("MDA code"),startIcon:t.jsxDEV(L,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:290,columnNumber:32},this),error:c.mdaCode,sx:n("mdaCode")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:283,columnNumber:19},this),t.jsxDEV(u,{id:"oemCode",label:s("OEM code"),value:o.oemCode??"",onChange:e=>$(e.target.value),placeholder:s("OEM code"),startIcon:t.jsxDEV(L,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:301,columnNumber:32},this),error:c.oemCode,sx:n("oemCode")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:295,columnNumber:19},this),t.jsxDEV(de,{id:"type",value:o.type??"",label:s("Type"),options:v,onChange:e=>U(e.target.value),placeholder:s("Type"),startIcon:t.jsxDEV(Ee,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:314,columnNumber:32},this),error:c.types,sx:n("type")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:306,columnNumber:19},this),t.jsxDEV(u,{id:"make",label:s("Make"),value:o.make??"",onChange:e=>B(e.target.value),placeholder:s("Make"),startIcon:t.jsxDEV(xe,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:325,columnNumber:32},this),error:c.make,sx:n("make")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:319,columnNumber:19},this),t.jsxDEV(u,{id:"models",label:s("Models"),value:o.models.join(", "),onChange:e=>G(e.target.value),placeholder:s("Models"),startIcon:t.jsxDEV(he,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:336,columnNumber:32},this),error:c.models,sx:n("models")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:330,columnNumber:19},this),t.jsxDEV(u,{id:"application",label:s("Application"),value:o.application??"",onChange:e=>K(e.target.value),placeholder:s("Application"),startIcon:t.jsxDEV(pe,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:347,columnNumber:32},this),error:c.application,sx:n("application")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:341,columnNumber:19},this),t.jsxDEV(u,{id:"kw",label:s("kW"),value:o.kw??"",onChange:e=>q(e.target.value),placeholder:s("kW"),startIcon:t.jsxDEV(y,{text:"kW"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:358,columnNumber:32},this),error:c.kw,sx:n("kw")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:352,columnNumber:19},this),t.jsxDEV(u,{id:"volt",label:s("Volt"),value:o.volt??"",onChange:e=>J(e.target.value),placeholder:s("Volt"),startIcon:t.jsxDEV(y,{text:"V"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:369,columnNumber:32},this),error:c.volt,sx:n("volt")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:363,columnNumber:19},this),t.jsxDEV(u,{id:"ampere",label:s("Ampere"),value:o.ampere??"",onChange:e=>Q(e.target.value),placeholder:s("Ampere"),startIcon:t.jsxDEV(y,{text:"A"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:380,columnNumber:32},this),error:c.ampere,sx:n("ampere")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:374,columnNumber:19},this),t.jsxDEV(u,{id:"rotation",label:s("Rotation"),value:o.rotation??"",onChange:e=>X(e.target.value),placeholder:s("Rotation"),startIcon:t.jsxDEV(ve,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:391,columnNumber:32},this),error:c.rotation,sx:n("rotation")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:385,columnNumber:19},this),t.jsxDEV(u,{id:"teeth",label:s("Teeth"),value:o.teeth??"",onChange:e=>Y(e.target.value),placeholder:s("Teeth"),startIcon:t.jsxDEV(je,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:402,columnNumber:32},this),error:c.teeth,sx:n("teeth")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:396,columnNumber:19},this),t.jsxDEV(u,{id:"regulator",label:s("Regulator"),value:o.regulator??"",onChange:e=>Z(e.target.value),placeholder:s("Regulator"),startIcon:t.jsxDEV(Ne,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:413,columnNumber:32},this),error:c.regulator,sx:n("regulator")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:407,columnNumber:19},this),t.jsxDEV(u,{id:"notes",label:s("Notes"),value:o.notes??"",onChange:e=>_(e.target.value),placeholder:s("Notes"),startIcon:t.jsxDEV(fe,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:424,columnNumber:32},this),multiline:!0,rows:2,error:c.notes,sx:n("notes"),spellCheck:!1},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:418,columnNumber:19},this),t.jsxDEV(u,{id:"image",label:s("Image"),value:o.imageNameOriginal??"",onChange:e=>w(e.target.value),placeholder:s("Image"),startIcon:t.jsxDEV(ge,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:438,columnNumber:32},this),error:c.image,disabled:!0,sx:n("imageNameOriginal"),endIcon:t.jsxDEV(D,{id:"imageUpload",variant:"contained",component:"label",size:"small",sx:{position:"absolute",width:"auto",right:4,mt:-.8},children:[s("Choose"),t.jsxDEV("input",{type:"file",hidden:!0,onChange:W},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:451,columnNumber:25},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:443,columnNumber:23},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:432,columnNumber:19},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:281,columnNumber:17},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:280,columnNumber:15},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:279,columnNumber:13},this),t.jsxDEV(P,{item:!0,xs:12,sm:6,children:t.jsxDEV(b,{display:"flex",flexDirection:"column",gap:2,alignItems:"center",justifyContent:"space-between",sx:{height:"100%"},children:[t.jsxDEV(b,{display:"flex",flexDirection:"column",gap:1,mt:{xs:-1,sm:1},alignItems:"center",flexGrow:1,children:[t.jsxDEV(M,{src:`${S.siteUrl}${S.images.publicPathWaterMark}/${o.imageName}`,alt:s("Current image"),borderColor:"primary.main",backgroundColor:"background.default",label:i.imageNameOriginal},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:478,columnNumber:19},this),C&&t.jsxDEV(M,{src:C,alt:s("Image being uploaded"),borderColor:"primary.main",backgroundColor:"background.default",label:E.name},C,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:487,columnNumber:46},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:475,columnNumber:17},this),t.jsxDEV(b,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2,mb:.5},children:[t.jsxDEV(D,{onClick:ee,variant:"contained",color:"success",size:"large",children:s("Confirm")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:507,columnNumber:19},this),t.jsxDEV(D,{onClick:se,variant:"contained",color:"secondary",size:"small",children:s("Cancel")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:515,columnNumber:19},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:498,columnNumber:17},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:465,columnNumber:15},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:464,columnNumber:13},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:277,columnNumber:11},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:269,columnNumber:9},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:263,columnNumber:7},this)}const ke=ie.memo(Ve);export{ke as default};
