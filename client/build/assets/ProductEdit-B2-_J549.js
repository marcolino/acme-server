import{a as h,b as p,at as O,j as t,av as ae,T as re,R as me,d as ce,r as u,A as le,f as ne,u as ue,e as de,k as g,dn as pe,B as b,G as P,C as D,c as L}from"./index-kZazlTzH.js";import{S as he}from"./Select-Dno9dEV7.js";import{S as d}from"./TextField-BpUCQOYc.js";import{I as T}from"./ImageContainer-CwQrxFcR.js";import"./Select-BP4I_6h9.js";const A=h(p.jsx("path",{d:"m14 12-2 2-2-2 2-2zm-2-6 2.12 2.12 2.5-2.5L12 1 7.38 5.62l2.5 2.5zm-6 6 2.12-2.12-2.5-2.5L1 12l4.62 4.62 2.5-2.5zm12 0-2.12 2.12 2.5 2.5L23 12l-4.62-4.62-2.5 2.5zm-6 6-2.12-2.12-2.5 2.5L12 23l4.62-4.62-2.5-2.5z"}),"Api"),fe=h(p.jsx("path",{d:"M4 8h4V4H4zm6 12h4v-4h-4zm-6 0h4v-4H4zm0-6h4v-4H4zm6 0h4v-4h-4zm6-10v4h4V4zm-6 4h4V4h-4zm6 6h4v-4h-4zm0 6h4v-4h-4z"}),"Apps"),Ne=h(p.jsx("path",{d:"M12 4H5C3.34 4 2 5.34 2 7v8c0 1.66 1.34 3 3 3l-1 1v1h1l2-2.03L9 18v-5H4V5.98L13 6v2h2V7c0-1.66-1.34-3-3-3M5 14c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m15.57-4.34c-.14-.4-.52-.66-.97-.66h-7.19c-.46 0-.83.26-.98.66L10 13.77l.01 5.51c0 .38.31.72.69.72h.62c.38 0 .68-.38.68-.76V18h8v1.24c0 .38.31.76.69.76h.61c.38 0 .69-.34.69-.72l.01-1.37v-4.14zm-8.16.34h7.19l1.03 3h-9.25zM12 16c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m8 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"Commute"),xe=h(p.jsx("path",{d:"M18.92 5.01C18.72 4.42 18.16 4 17.5 4h-11c-.66 0-1.21.42-1.42 1.01L3 11v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8zM6.5 15c-.83 0-1.5-.67-1.5-1.5S5.67 12 6.5 12s1.5.67 1.5 1.5S7.33 15 6.5 15m11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5M5 10l1.5-4.5h11L19 10z"}),"DriveEta"),ge=h(p.jsx("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote"),be=h(p.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M6 7h5v1.5H6zm13 12H5L19 5zm-4.5-3v2H16v-2h2v-1.5h-2v-2h-1.5v2h-2V16z"}),"Exposure"),je=h([p.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),p.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"PhotoCamera"),ve=h(p.jsx("path",{d:"M16.01 7 16 3h-2v4h-4V3H8v4h-.01C7 6.99 6 7.99 6 8.99v5.49L9.5 18v3h5v-3l3.5-3.51v-5.5c0-1-1-2-1.99-1.99"}),"Power"),Ee=h(p.jsx("path",{d:"M17.41 6.59 15 5.5l2.41-1.09L18.5 2l1.09 2.41L22 5.5l-2.41 1.09L18.5 9zm3.87 6.13L20.5 11l-.78 1.72-1.72.78 1.72.78.78 1.72.78-1.72L23 13.5zm-5.04 1.65 1.94 1.47-2.5 4.33-2.24-.94c-.2.13-.42.26-.64.37l-.3 2.4h-5l-.3-2.41c-.22-.11-.43-.23-.64-.37l-2.24.94-2.5-4.33 1.94-1.47c-.01-.11-.01-.24-.01-.36s0-.25.01-.37l-1.94-1.47 2.5-4.33 2.24.94c.2-.13.42-.26.64-.37L7.5 6h5l.3 2.41c.22.11.43.23.64.37l2.24-.94 2.5 4.33-1.94 1.47c.01.12.01.24.01.37s0 .24-.01.36M13 14c0-1.66-1.34-3-3-3s-3 1.34-3 3 1.34 3 3 3 3-1.34 3-3"}),"SettingsSuggest"),Ce=h(p.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"}),"Sync"),Ve=h(p.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"}),"TurnedInNotOutlined"),Pe=ae("div")(({theme:x})=>({position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center"}));function y({iconSize:x=1.6,textSize:o=.6,text:i="",iconProps:a={},countProps:j={}}){const v=O();return t.jsxDEV(Pe,{children:[t.jsxDEV(ve,{sx:{fontSize:x+"em",...a.sx},...a},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/glyphs/PowerWithText.jsx",lineNumber:23,columnNumber:7},this),t.jsxDEV(re,{component:"span",sx:{position:"absolute",lineHeight:1,color:v.palette.background.default,top:o*1.5+"em",fontSize:o+"em!important",...j.sx},...j,children:i},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/glyphs/PowerWithText.jsx",lineNumber:30,columnNumber:7},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/glyphs/PowerWithText.jsx",lineNumber:22,columnNumber:5},this)}function De(){const x=ce();O();const[o,i]=u.useState(!1),[a,j]=u.useState(!1),[v,H]=u.useState([]),[c,I]=u.useState({}),{auth:R}=u.useContext(le),{showSnackbar:f}=ne(),k=u.useRef(null),{t:s}=ue(),{productId:N}=de();if(!N){f(s("No product id specified"),"error"),x(-1);return}const W=()=>{k.current.click()},[z,w]=u.useState(!1),[E,U]=u.useState(null),[C,F]=u.useState(null),[m,l]=u.useState({});u.useEffect(()=>{R.user&&(async()=>{const e=await g("get","/product/getProductAllTypes");e.err?f(e.message,e.status===401?"warning":"error"):H(e.types)})()},[]);const S=e=>{e.target.files.length>1&&f(s("More than one image selected, using the first one"),"info");const r=e.target.files[0];r&&(U(r),F(URL.createObjectURL(r)),M(r.name))};u.useEffect(()=>{(async()=>{if(N==="<new>")console.log("NEW PRODUCT"),i({mdaCode:"",oemCode:"",make:"",models:[],application:"",kw:"",volt:"",ampere:"",teeth:"",rotation:"",regulator:"",type:"",imageNameOriginal:"",imageName:"",notes:""});else{const e=await g("get","/product/getProduct",{productId:N});e.err?f(e.message,e.status===401?"warning":"error"):(i(e.product),j(e.product))}})()},[N]),u.useEffect(()=>{z&&(w(!1),oe())},[z]);const $=e=>{i({...o,type:e}),l({...m,type:e!=a.type})},B=e=>{i({...o,mdaCode:e}),l({...m,mdaCode:e!=a.mdaCode})},G=e=>{i({...o,oemCode:e}),l({...m,oemCode:e!=a.oemCode})},K=e=>{i({...o,make:e}),l({...m,make:e!=a.make})},q=e=>{i({...o,models:e.split(", ")}),l({...m,models:e!=a.models})},J=e=>{i({...o,application:e}),l({...m,application:e!=a.application})},Q=e=>{i({...o,kw:e}),l({...m,kw:e!=a.kw})},X=e=>{i({...o,volt:e}),l({...m,volt:e!=a.volt})},Y=e=>{i({...o,ampere:e}),l({...m,ampere:e!=a.ampere})},Z=e=>{i({...o,rotation:e}),l({...m,rotation:e!=a.rotation})},_=e=>{i({...o,teeth:e}),l({...m,teeth:e!=a.teeth})},ee=e=>{i({...o,regulator:e}),l({...m,regulator:e!=a.regulator})},te=e=>{i({...o,notes:e}),l({...m,notes:e!=a.notes})},M=e=>{i({...o,imageNameOriginal:e}),l({...m,imageNameOriginal:e!=a.imageNameOriginal})},se=e=>{e.preventDefault(),w(!0),I({})},oe=async()=>{try{let e,r;if(N==="<new>"?(r=await g("post","/product/insertProduct",{product:o}),e=r.id):(r=await g("post","/product/updateProduct",{productId:N,product:o}),e=N),r.err)return f(r.message,"error");if(E){const V=new FormData;if(V.append("productId",e),V.append("image",E),r=await g("post","/product/uploadProductImage",V),r.err)return r.message==="Input buffer contains unsupported image format"&&(r.message=s("Image format unsupported")),f(r.message,"error")}x(-1)}catch(e){f(`An error occurred updating the product: ${e.message}`,"error"),console.error(e)}},ie=e=>{e.preventDefault(),I({}),x(-1)},n=e=>{const r={fontWeight:m[e]?"bold":"normal"};return{...r,input:r}};if(console.log("product.imageName:",o.imageName),o&&v.length)return t.jsxDEV(t.Fragment,{children:[t.jsxDEV(pe,{text:s("Products handling"),children:s("Edit product")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:273,columnNumber:9},this),t.jsxDEV(b,{sx:{display:"flex",justifyContent:"center",alignItems:"start",minHeight:"100vh"},children:t.jsxDEV(P,{container:!0,spacing:2,maxWidth:800,children:[t.jsxDEV(P,{item:!0,xs:12,sm:6,children:t.jsxDEV(b,{display:"flex",flexDirection:"column",gap:2,children:t.jsxDEV("form",{noValidate:!0,autoComplete:"off",children:[t.jsxDEV(d,{autoFocus:!0,id:"mdaCode",label:s("MDA code"),value:o.mdaCode??"",onChange:e=>B(e.target.value),placeholder:s("MDA code"),startIcon:t.jsxDEV(A,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:298,columnNumber:32},this),error:c.mdaCode,sx:n("mdaCode")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:291,columnNumber:19},this),t.jsxDEV(d,{id:"oemCode",label:s("OEM code"),value:o.oemCode??"",onChange:e=>G(e.target.value),placeholder:s("OEM code"),startIcon:t.jsxDEV(A,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:309,columnNumber:32},this),error:c.oemCode,sx:n("oemCode")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:303,columnNumber:19},this),t.jsxDEV(he,{id:"type",value:o.type??"",label:s("Type"),options:v,onChange:e=>$(e.target.value),placeholder:s("Type"),startIcon:t.jsxDEV(Ve,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:322,columnNumber:32},this),error:c.types,sx:n("type")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:314,columnNumber:19},this),t.jsxDEV(d,{id:"make",label:s("Make"),value:o.make??"",onChange:e=>K(e.target.value),placeholder:s("Make"),startIcon:t.jsxDEV(xe,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:333,columnNumber:32},this),error:c.make,sx:n("make")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:327,columnNumber:19},this),t.jsxDEV(d,{id:"models",label:s("Models"),value:o.models.join(", "),onChange:e=>q(e.target.value),placeholder:s("Models"),startIcon:t.jsxDEV(Ne,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:344,columnNumber:32},this),error:c.models,sx:n("models")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:338,columnNumber:19},this),t.jsxDEV(d,{id:"application",label:s("Application"),value:o.application??"",onChange:e=>J(e.target.value),placeholder:s("Application"),startIcon:t.jsxDEV(fe,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:355,columnNumber:32},this),error:c.application,sx:n("application")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:349,columnNumber:19},this),t.jsxDEV(d,{id:"kw",label:s("kW"),value:o.kw??"",onChange:e=>Q(e.target.value),placeholder:s("kW"),startIcon:t.jsxDEV(y,{text:"kW"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:366,columnNumber:32},this),error:c.kw,sx:n("kw")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:360,columnNumber:19},this),t.jsxDEV(d,{id:"volt",label:s("Volt"),value:o.volt??"",onChange:e=>X(e.target.value),placeholder:s("Volt"),startIcon:t.jsxDEV(y,{text:"V"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:377,columnNumber:32},this),error:c.volt,sx:n("volt")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:371,columnNumber:19},this),t.jsxDEV(d,{id:"ampere",label:s("Ampere"),value:o.ampere??"",onChange:e=>Y(e.target.value),placeholder:s("Ampere"),startIcon:t.jsxDEV(y,{text:"A"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:388,columnNumber:32},this),error:c.ampere,sx:n("ampere")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:382,columnNumber:19},this),t.jsxDEV(d,{id:"rotation",label:s("Rotation"),value:o.rotation??"",onChange:e=>Z(e.target.value),placeholder:s("Rotation"),startIcon:t.jsxDEV(Ce,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:399,columnNumber:32},this),error:c.rotation,sx:n("rotation")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:393,columnNumber:19},this),t.jsxDEV(d,{id:"teeth",label:s("Teeth"),value:o.teeth??"",onChange:e=>_(e.target.value),placeholder:s("Teeth"),startIcon:t.jsxDEV(Ee,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:410,columnNumber:32},this),error:c.teeth,sx:n("teeth")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:404,columnNumber:19},this),t.jsxDEV(d,{id:"regulator",label:s("Regulator"),value:o.regulator??"",onChange:e=>ee(e.target.value),placeholder:s("Regulator"),startIcon:t.jsxDEV(be,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:421,columnNumber:32},this),error:c.regulator,sx:n("regulator")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:415,columnNumber:19},this),t.jsxDEV(d,{id:"notes",label:s("Notes"),value:o.notes??"",onChange:e=>te(e.target.value),placeholder:s("Notes"),startIcon:t.jsxDEV(ge,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:432,columnNumber:32},this),multiline:!0,rows:2,error:c.notes,sx:n("notes"),spellCheck:!1},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:426,columnNumber:19},this),t.jsxDEV(d,{id:"image",label:s("Image"),value:o.imageNameOriginal??"",onChange:e=>M(e.target.value),placeholder:s("Image"),startIcon:t.jsxDEV(je,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:446,columnNumber:32},this),error:c.image,disabled:!0,sx:n("imageNameOriginal"),endIcon:t.jsxDEV(D,{id:"imageUpload",variant:"contained",component:"label",size:"small",sx:{position:"absolute",width:"auto",right:4,mt:-.8},children:[s("Choose"),t.jsxDEV("input",{type:"file",hidden:!0,onChange:S},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:459,columnNumber:25},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:451,columnNumber:23},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:440,columnNumber:19},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:289,columnNumber:17},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:288,columnNumber:15},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:287,columnNumber:13},this),t.jsxDEV(P,{item:!0,xs:12,sm:6,children:t.jsxDEV(b,{display:"flex",flexDirection:"column",gap:2,alignItems:"center",justifyContent:"space-between",sx:{height:"100%"},children:[t.jsxDEV(b,{display:"flex",flexDirection:"column",gap:1,mt:{xs:-1,sm:1},alignItems:"center",flexGrow:1,children:[t.jsxDEV("input",{type:"file",hidden:!0,ref:k,onChange:S},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:485,columnNumber:19},this),t.jsxDEV("div",{onClick:W,style:{cursor:"pointer"},children:t.jsxDEV(T,{src:o.imageName?`${L.siteUrl}${L.images.publicPathWaterMark}/${o.imageName}`:void 0,alt:s("Current image"),borderColor:"primary.main",backgroundColor:"background.default",label:a.imageNameOriginal},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:493,columnNumber:21},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:491,columnNumber:19},this),C&&t.jsxDEV(T,{src:C,alt:s("Image being uploaded"),borderColor:"primary.main",backgroundColor:"background.default",label:E.name},C,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:503,columnNumber:46},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:483,columnNumber:17},this),t.jsxDEV(b,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2,mb:.5},children:[t.jsxDEV(D,{onClick:se,variant:"contained",color:"success",size:"large",children:s("Confirm")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:523,columnNumber:19},this),t.jsxDEV(D,{onClick:ie,variant:"contained",color:"secondary",size:"small",children:s("Cancel")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:531,columnNumber:19},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:514,columnNumber:17},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:473,columnNumber:15},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:472,columnNumber:13},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:285,columnNumber:11},this)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:277,columnNumber:9},this)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductEdit.jsx",lineNumber:271,columnNumber:7},this)}const Se=me.memo(De);export{Se as default};
