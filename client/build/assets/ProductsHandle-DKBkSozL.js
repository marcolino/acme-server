import{a as ee,b as se,R as B,at as ne,d as oe,f as ie,o as re,u as ce,r as N,dk as ae,k,dv as V,dw as le,dx as te,dy as me,dz as de,dA as ue,dB as pe,j as s,dm as fe,B as w,C as y,az as he,I as S,T as Ne}from"./index-B-g6q7zv.js";import{D as T,C as xe,S as be,a as je,b as ge}from"./StackedArrows-D6eruMyO.js";import{e as ve,b as Pe,f as Ee,h as R,d as c,c as De,E as Ce,g as He}from"./Edit-CQLBvbYg.js";import{C as A}from"./Checkbox-BCEoa6f3.js";import"./TextField-DuAedfdf.js";import"./TextField-CH4Jx1xX.js";import"./Select-DeDA1KrM.js";const ke=ee(se.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline"),Ve=()=>{const m=ne(),D=oe(),{showSnackbar:b}=ie(),{showDialog:C}=re(),{t:r}=ce(),[d,P]=N.useState([]),[j,L]=N.useState(""),z=[5,10,25,50,100],_=e=>l.indexOf(e)!==-1,[a,$]=N.useState("mdaCode"),[t,O]=N.useState("asc");T.fromJSDate(new Date).setLocale(ae.language).toLocaleString(T.DATETIME_FULL),N.useEffect(()=>((async()=>{const e=await k("get","/product/getProducts");e.err?b(e.message,e.status===401?"warning":"error"):P(e.products)})(),()=>{}),[]);const F=()=>{D("/edit-product/<new>")},H=e=>k("post","/product/removeProduct",e),M=e=>{D(`/edit-product/${e}`)},W=async e=>{H({filter:[e]}).then(n=>{if(n.err){console.warn("removeProduct error:",n),b(r("Error removing product: {{err}}",{err:n.message}),"error");return}P(o=>o.filter(i=>i._id!==e))}).catch(n=>{console.error(`Error removing product with id ${e}: ${n.message}`),b(r("Error removing product with id {{id}}: {{err}",{id:e,err:n.message}),"error")})},I=async(e,n)=>{H({filter:e,...n}).then(o=>{if(o.err){console.warn("bulkRemove product error:",o),b(r("Error bulk removing product: {{err}}",{err:o.message}),"error");return}P(i=>i.filter(x=>!e.includes(x._id))),v([]),b(r("Removed {{ count }} products",{count:e.length}),"success")}).catch(o=>{console.error(`Error bulk removing ${e.length} products with ids ${e}: ${o.message}`),b(r("Error bulk removing {{count}} products: {{err}}",{count:e.length,err:o.message}),"error")})},[E,U]=N.useState(0),[g,G]=N.useState(()=>parseInt(V.get("productsRowsPerPage"))||10),[l,v]=N.useState([]),J=e=>{L(e.target.value)},q=(e,n)=>{U(n)},K=e=>{const n=parseInt(e.target.value);G(n),V.set("productsRowsPerPage",n)},Q=e=>{if(e.target.checked){const n=d.map(o=>o._id);v(n);return}v([])},X=(e,n)=>{const o=l.indexOf(n);let i=[];o===-1?i=i.concat(l,n):o===0?i=i.concat(l.slice(1)):o===l.length-1?i=i.concat(l.slice(0,-1)):o>0&&(i=i.concat(l.slice(0,o),l.slice(o+1))),v(i)},u=e=>()=>{let n="asc";a===e&&t==="asc"&&(n="desc"),$(e),O(n)},Y=B.useMemo(()=>{let e=[...d];return a!==null&&e.sort((n,o)=>{var i,x;if(le(n[a])){let f=(i=n[a])==null?void 0:i.toLowerCase(),h=(x=o[a])==null?void 0:x.toLowerCase();return f<h?t==="asc"?-1:1:f>h?t==="asc"?1:-1:0}if(te(n[a])||me(n[a])){const f=n[a],h=o[a];return f<h?t==="asc"?-1:1:f>h?t==="asc"?1:-1:0}if(de(n[a])){let f=n[a][0].priority,h=o[a][0].priority;if(f<h)return t==="asc"?-1:1;if(f>h)return t==="asc"?1:-1}return ue(n[a])?t==="asc"?-1:1:pe(n[a])?(console.warn(`sort of "object" field type for column ${a} is not implemented yet!`),0):(console.error(`sort of unknown field type for column ${a} is not implemented yet!`),0)}),e},[d,a,t]),Z=()=>{if(!d||!d.length)return[];const e=j==null?void 0:j.toLowerCase(),n=i=>j?o(i,"mdaCode")||o(i,"oemCode")||o(i,"make")||o(i,"application")||o(i,"kw")||o(i,"volt")||o(i,"ampere")||o(i,"teeth")||o(i,"type")||o(i,"notes"):!0,o=(i,x)=>!i||!i[x]?!1:i[x].toString().toLowerCase().includes(e);return Y.filter(i=>n(i)).slice(E*g,E*g+g)},p=e=>s.jsxDEV(Ne,{component:"span",children:a===e.column?t==="asc"?"▼":"▲":s.jsxDEV(ge,{opacity:.4},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:283,columnNumber:82},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:282,columnNumber:7},void 0);return s.jsxDEV(s.Fragment,{children:[s.jsxDEV(fe,{children:r("Products handling")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:292,columnNumber:7},void 0),s.jsxDEV(w,{sx:{my:m.spacing(2),display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},children:[s.jsxDEV(xe,{label:r("Search"),value:j,size:"small",margin:"dense",onChange:J,startIcon:s.jsxDEV(be,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:309,columnNumber:22},void 0),fullWidth:!1,sx:{color:m.palette.text.primary}},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:303,columnNumber:9},void 0),s.jsxDEV(y,{onClick:F,fullWidth:!1,variant:"contained",color:"primary",size:"small",startIcon:s.jsxDEV(ke,{},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:319,columnNumber:22},void 0),hideChildrenUpToBreakpoint:"sm",sx:{mt:m.spacing(.3),py:m.spacing(.8),ml:m.spacing(2)},children:r("New product")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:313,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:296,columnNumber:7},void 0),s.jsxDEV(he,{sx:{overflow:"hidden",backgroundColor:m.palette.background.default,color:m.palette.text.secondary},children:[s.jsxDEV(ve,{sx:{maxHeight:"max(12rem, calc(100vh - 26rem))"},children:s.jsxDEV(Pe,{stickyHeader:!0,"aria-label":"sticky table",children:[s.jsxDEV(Ee,{children:s.jsxDEV(R,{sx:e=>({"& th":{backgroundColor:e.palette.secondary.main,color:e.palette.common.black,py:0,whiteSpace:"nowrap"}}),children:[s.jsxDEV(c,{padding:"checkbox",children:s.jsxDEV(A,{indeterminate:l.length>0&&l.length<d.length,checked:d.length>0&&l.length===d.length,onChange:Q},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:351,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:350,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("mdaCode"),children:[r("MDA code")," ",p({column:"mdaCode"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:357,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("oemCode"),children:[r("OEM code")," ",p({column:"oemCode"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:360,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("make"),children:[r("Make")," ",p({column:"make"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:363,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("application"),children:[r("Application")," ",p({column:"application"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:369,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("kw"),children:[r("kW")," ",p({column:"kw"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:372,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("volt"),children:[r("Volt")," ",p({column:"volt"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:375,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("ampere"),children:[r("Ampere")," ",p({column:"ampere"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:378,columnNumber:17},void 0),s.jsxDEV(c,{children:r("Teeth")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:381,columnNumber:17},void 0),s.jsxDEV(c,{onClick:u("type"),children:[r("Type")," ",p({column:"type"})]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:384,columnNumber:17},void 0),s.jsxDEV(c,{children:r("Notes")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:387,columnNumber:17},void 0),s.jsxDEV(c,{children:r("Actions")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:390,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:341,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:340,columnNumber:13},void 0),s.jsxDEV(De,{children:Z().map(e=>{const n=_(e._id);return s.jsxDEV(R,{hover:!0,onClick:o=>X(o,e._id),role:"checkbox","aria-checked":n,tabIndex:-1,selected:n,sx:o=>({"& td":{backgroundColor:o.palette.ochre.light,color:o.palette.common.text,py:0}}),children:[s.jsxDEV(c,{padding:"checkbox",children:s.jsxDEV(A,{checked:n},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:421,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:420,columnNumber:23},void 0),s.jsxDEV(c,{children:e.mdaCode},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:423,columnNumber:23},void 0),s.jsxDEV(c,{children:e.oemCode},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:424,columnNumber:23},void 0),s.jsxDEV(c,{children:e.make},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:425,columnNumber:23},void 0),s.jsxDEV(c,{children:e.application},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:427,columnNumber:23},void 0),s.jsxDEV(c,{children:e.kw},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:428,columnNumber:23},void 0),s.jsxDEV(c,{children:e.volt},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:429,columnNumber:23},void 0),s.jsxDEV(c,{children:e.ampere},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:430,columnNumber:23},void 0),s.jsxDEV(c,{children:e.teeth},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:431,columnNumber:23},void 0),s.jsxDEV(c,{children:e.type},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:432,columnNumber:23},void 0),s.jsxDEV(c,{children:e.notes},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:433,columnNumber:23},void 0),s.jsxDEV(c,{children:[s.jsxDEV(S,{size:"small",onClick:()=>M(e._id),children:s.jsxDEV(Ce,{fontSize:"small"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:436,columnNumber:27},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:435,columnNumber:25},void 0),s.jsxDEV(S,{size:"small",onClick:()=>C({onConfirm:()=>W(e._id),title:r("Confirm Delete"),message:r("Are you sure you want to delete {{count}} selected product?",{count:1}),confirmText:r("Confirm"),cancelText:r("Cancel")}),children:s.jsxDEV(je,{fontSize:"small"},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:445,columnNumber:27},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:438,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:434,columnNumber:23},void 0)]},e._id,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:404,columnNumber:21},void 0)})},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:395,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:339,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:336,columnNumber:9},void 0),s.jsxDEV(He,{rowsPerPageOptions:z,component:"div",count:d.length,rowsPerPage:g,page:E,onPageChange:q,onRowsPerPageChange:K},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:454,columnNumber:9},void 0),s.jsxDEV(w,{sx:{padding:m.spacing(2)},children:s.jsxDEV(y,{variant:"contained",color:"primary",fullWidth:!1,onClick:()=>C({onConfirm:()=>I(l),title:r("Confirm Delete"),message:r("Are you sure you want to delete {{count}} selected product?",{count:l.length}),confirmText:r("Confirm"),cancelText:r("Cancel")}),disabled:l.length===0,sx:{mr:m.spacing(2)},children:r("Remove selected products")},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:464,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:463,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:331,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/marco/apps/sistemisolari/acme-client/src/components/ProductsHandle.jsx",lineNumber:291,columnNumber:5},void 0)},Le=B.memo(Ve);export{Le as default};
